
<?php
	$currenturl = remove_query_arg('delete',sanitize_text_field($_SERVER['REQUEST_URI']));
	$currenturl = remove_query_arg('view',$currenturl);
	$currenturl = remove_query_arg('trust',$currenturl);
	$currenturl = remove_query_arg('trustchanged',$currenturl);
?>


<div class="nav-tab-wrapper">
	<button class="nav-tab" onclick="mo2f_wpns_openTabmalware(this)" id="mo2f_malware_view">Malware Scan Modes</button>
    <button class="nav-tab" onclick="mo2f_wpns_openTabmalware(this)" id="mo2f_scan_set">Custom Scan Settings</button>
    <button class="nav-tab" onclick="mo2f_wpns_openTabmalware(this)" id="mo2f_report_scan">Scan Reports</button>
    <input type = "hidden" id = "wpns_report_nonce" value="<?php echo esc_html(wp_create_nonce('wpns-report-load')) ?>" >
</div>

<div>
	<div class="tabcontent" id="mo2f_malware_view_div">
		<div class="mo_wpns_divided_layout">
			<table style="width: 100%;">
				<tr>
					<td style="width:100%;vertical-align:top;" id="configurationForm">
						<?php include_once $mo2f_dirName . 'controllers'.DIRECTORY_SEPARATOR.'malware_scanner'.DIRECTORY_SEPARATOR.'scan_malware_summary.php'; ?>
				</tr>
			</table>
		</div>
	</div>
	<div class="tabcontent" id="mo2f_scan_set_div">
		<div class="mo_wpns_divided_layout">
			<table style="width: 100%;">
				<tr>
					<td style="width:100%;vertical-align:top;" id="configurationForm">
						<?php include_once $mo2f_dirName . 'controllers'.DIRECTORY_SEPARATOR.'malware_scanner'.DIRECTORY_SEPARATOR.'scan_malware_settings.php'; ?>
				</tr>
			</table>
		</div>
	</div>
<div class="tabcontent" id="mo2f_report_scan_div">
	<div class="mo_wpns_divided_layout">
		<table style="width: 100%;">
			<tr>
				<td style="width:100%;vertical-align:top;" id="configurationForm">
					<?php include_once $mo2f_dirName . 'controllers'.DIRECTORY_SEPARATOR.'malware_scanner'.DIRECTORY_SEPARATOR.'scan_malware_report.php'; ?>
			</tr>
		</table>
	</div>
</div>
</div>
<script>

		function mo2f_wpns_openTabmalware(elmt){
			var tabname = elmt.id;
			var tabarray = ["mo2f_malware_view","mo2f_scan_set","mo2f_report_scan"];
			for (var i = 0; i < tabarray.length; i++) {
				if(tabarray[i] == tabname){
					jQuery("#"+tabarray[i]).addClass("nav-tab-active");
					jQuery("#"+tabarray[i]+"_div").css("display", "block");
				}else{
					jQuery("#"+tabarray[i]).removeClass("nav-tab-active");
					jQuery("#"+tabarray[i]+"_div").css("display", "none");
				}
			}
			localStorage.setItem("malware_last_tab", tabname);
		}	

		jQuery('#malware_tab').addClass('nav-tab-active');

		var tab = localStorage.getItem("malware_last_tab"); 

		if(tab)
			document.getElementById(tab).click();
		else{
			document.getElementById("mo2f_malware_view").click();
		}


</script>